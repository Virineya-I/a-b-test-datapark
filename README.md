# Кризис в таксопарке Datapark

## Описание кейса

**Проблема сервиса:** Заказы поступают без остановки, но водителей не хватает. Система назначения буксует: одни клиенты ждут слишком долго, другие отменяют поездку. Чтобы повысить назначаемость водителей команда таксопарка запустила продуктовый эксперимент с тестированием эффективности расширения радиуса.     
**Условие A/B-теста:** Половина заказов осталась с привычным радиусом поиска в 3 км, а вторая половина получила расширенный радиус — 5 км.
Заказы определялись в группы рандомным образом.     
**Гипотеза:** Чем шире радиус, тем выше шанс найти водителя. Но риск очевиден - слишком дальняя подача может испортить пользовательский опыт.    

**А/В-эксперимент**

Заказы пользователей в течение недели случайным образом разделили на две равные группы: 
- Контрольная группа - радиус поиска 3 км.
- Тестовая группа - радиус поиска 5 км.

Чтобы увидеть полную картину выберем для эксперимента такой набор метрик: 
- Ключевая метрика — конверсии из _order_ в _assign_.
- Барьерная метрика — конверсии из _assign_ в _arrive_ (необходимо следить, чтобы дальняя подача машины не привела к отмене заказа после назначения водителя).
- Вспомогательная метрика 1 — среднее времени назначения водителя на заказ.
- Вспомогательная метрика 2 — конверсия из _order_ в _trip_.

Ожидалось, что ключевая и вспомогательная метрика 2 покажут рост, барьерная метрика и вспомогательная метрика 1  не упадут.

## Задачи аналитика

- Убедиться, что сплит-система А/В-теста работает работает верно и разбирает заказы 50/50;     
- Провести полный анализ результатов А/В-эксперимента;
- Предложить способ определять отложенные заказы и исследовать их влияние на результаты А/В-теста.

## Описание данных

Датасет `delo_datapark.csv` содержит данные А/В-эксперимента — идентификатор и временные данные заказа. Пользователи уже распределены по группам А/В-эксперимента.

- `id_order` — уникальный идентификатор заказа.;
- `test_group` — флаг, относящий заказ к контрольной или тестовой группе;
- `time_order` — дата + время создания заказа;
- `time_offer` — дата + время первого предложения заказа водителю;
- `time_assign` — дата + время согласия и назначения водителя на заказ;
- `time_arrive` — дата + время прибытия водителя в точку «А»;
- `trip_time` — дата + время успешного окончания поездки в точке «В».

## План проекта

1. Загрузка данных и их предобработка;
2. Исследовательский анализ отложенных заказов и их влияния на результаты А/В-теста;
3. Исследование изменения метрик;
4. Анализ результатов А/В эксперимента;
5. Выводы.

## Выводы

- Сплит-система А/В-теста работает работает корректно, разбиение заказов в данном тесте 54/46, однако в тестовой группе практически в 300 раз больше отложенных заказов, что может отрицательно сказаться на достоверности результатов теста, так как клиенты с отложенным заказом будут менее чувствительны к более долгому ожиданию машины.
- Абсолютное изменение значения конверсии из оформления заказа в назначение водителя на поездку в тестовой группе по сравнению с контрольной  5.16, относительное  6.84%, и это изменение статистически значимо, однако, конверсия из _assign_ в _arrive_ в тестовой группе снизилась на 12.25%, по сравнению с контрольной группой, что говорит о том, что более дальняя подача машины и увеличенное время ожидания увеличивают число отмен со стороны клиентов после назначения водителя.    
- Среднее времени назначения водителя на заказ не изменяется, при этом конверсии из _order_ в _trip_ в тестовой группе снизилась на 7.99% по сравнению с контрольной группой.
- Исходя из распределения времени от оформления заказа до момента назначения водителя на заказ, определено, что заказы с временем от _order_ до _assign_ более 50 минут относятся к отложенным заказам. Без поправки на отложенные заказы временные значения в тестовой группе сильно завышены по сравнению с контрольной группой.

## Рекомендации

- При сплитовании стоит учитывать отложенные заказы и более равномерно распределять их по группам, во избежание искажения результатов. За качестве границы стоит ориентироваться на величину в 50 минут.         
- По результатам А/В-теста наблюдается статически значимое улучшение конверсии из оформления заказа в назначение водителя на поездку в тестовой группе, но уменьшается конверсия из _assign_ в _arrive_ и из _order_ в _trip_, таким образом запуск расширения радиуса поиска может привести к ухудшению пользовательского опыта и снижению общей выручки.
